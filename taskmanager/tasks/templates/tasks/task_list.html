{% load static %}
<link rel="stylesheet" type="text/css" href="{% static 'css/style.css' %}">

<!-- <script>
    setTimeout(function(){
        let messages = document.querySelector('.messages');
        if (messages) {
            messages.style.display = 'none';
        }
    }, 2000);
</script> -->

<script>
    document.addEventListener('DOMContentLoaded', function () {
        let messages = document.querySelectorAll('.messages li');
        if (messages) {
        messages.forEach(function(message) {
            setTimeout(() => {
                message.style.animation = 'fadeOut 0.5s ease-in-out';
                setTimeout(() => {
                    message.remove();
                }, 500);
            }, 2000);
        })
    }
    })
</script>
<script src="{% static 'js/script.js' %}"></script>



<h2>–§–∏–ª—å—Ç—Ä</h2>
<form method="GET" action="{% url 'tasks' %}"> 
    <label for="category">–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</label>
    <select name="category" id="category">
        <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
        {% for category in categories %}
        <option value="{{ category.id }}" {% if request.GET.category == category.id|stringformat:"s" %} selected {% endif %}>
            {{ category.name }}
        </option>
        {% endfor %}
    </select>
        <label for="status">–°—Ç–∞—Ç—É—Å:</label>
        <select name="status" id="status">
            <option value="">–í—Å–µ</option>
            
            <option value="completed" {% if request.GET.status == "completed" %} selected {% endif %}>
                –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ
            </option>
            <option value="incomplete" {% if request.GET.status == "incomplete" %} selected {% endif %}>
                –ù–µ–≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ
            </option>
        </select>
        <button type="submit">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
</form>


<h2>–í–∞—à–∏ —Ç–µ–∫—É—â–∏–µ –∑–∞–¥–∞—á–∏</h2>
<!-- –°–æ–æ–±—â–µ–Ω–∏—è -->
{% if messages %}
<ul class="messages">
    {% for message in messages %}
    <li class="{{ message.tags }}">{{ message }}</li>
    {% endfor %}
</ul>
{% endif %}
<!-- <a href="{% url 'create_task' %}" class="btn-create" id="open-modal">–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É ‚ûï</a> -->
<a href="#" class="btn-create" id="open-modal">–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É ‚ûï</a>
<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ -->
 <div id="task-modal" class="modal">
    <div class="modal-content">
        <span class="close-modal" id="close-modal">√ó</span>
        <h2>–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É</h2>
        <form method="post" id="task-form">
            {% csrf_token %}
            {{ form.as_p}}
            <button type="submit">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </form>
        <a href="{% url 'tasks' %}">–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Å–ø–∏—Å–∫—É –∑–∞–¥–∞—á</a>
    </div>
</div>




<!-- –°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á -->
<ul>
    {% for task in tasks %}
    <li>{{ task.title }} - {% if task.completed %} ‚úî {% else %} ‚ùå {% endif %}
        <a href="{% url 'edit_task' task.id %}">‚úèÔ∏è</a>
        <a href="{% url 'delete_task' task.id %}">üóëÔ∏è</a>
    </li>
    {% endfor %}
</ul>
<a href="{% url 'logout' %}">–í—ã–π—Ç–∏</a>